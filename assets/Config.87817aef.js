import{r as U,b as c,j as t,k as y,s as j,i as _,c as V,l as W,n as L,o as P,q as H,e as T,t as G,h as $,v as q,w as F,x as C,y as J,u as K,C as Q,z as X,B as Y,A as Z,D as ee}from"./index.70ba2435.js";import{r as te}from"./logs.1f30d846.js";import{S as w}from"./Select.4faa7bf0.js";function ne(e,o){if(e==null)return{};var r=ae(e,o),l,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)l=s[a],!(o.indexOf(l)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,l)||(r[l]=e[l]))}return r}function ae(e,o){if(e==null)return{};var r={},l=Object.keys(e),a,s;for(s=0;s<l.length;s++)a=l[s],!(o.indexOf(a)>=0)&&(r[a]=e[a]);return r}var S=U.exports.forwardRef(function(e,o){var r=e.color,l=r===void 0?"currentColor":r,a=e.size,s=a===void 0?24:a,u=ne(e,["color","size"]);return c("svg",{ref:o,xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:l,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...u,children:[t("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t("polyline",{points:"16 17 21 12 16 7"}),t("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})});S.propTypes={color:y.exports.string,size:y.exports.oneOfType([y.exports.string,y.exports.number])};S.displayName="LogOut";const se=S,{useState:oe,useRef:le,useEffect:re,useCallback:ce}=_;function ie(e){return t("input",{className:j.input,...e})}function de({value:e,...o}){const[r,l]=oe(e),a=le(e);re(()=>{a.current!==e&&l(e),a.current=e},[e]);const s=ce(u=>l(u.target.value),[l]);return t("input",{className:j.input,value:r,onChange:s,...o})}const ue="_root_v2s4h_1",pe="_section_v2s4h_2",he="_wrapSwitch_v2s4h_26",ge="_sep_v2s4h_32",fe="_label_v2s4h_45",i={root:ue,section:pe,wrapSwitch:he,sep:ge,label:fe},ve="_fieldset_1ghjp_1",me="_input_1ghjp_9",ye="_cnt_1ghjp_9",k={fieldset:ve,input:me,cnt:ye};function be({OptionComponent:e,optionPropsList:o,selectedIndex:r,onChange:l}){const a=V("visually-hidden",k.input),s=u=>{l(u.target.value)};return t("fieldset",{className:k.fieldset,children:o.map((u,h)=>c("label",{children:[t("input",{type:"radio",checked:r===h,name:"selection",value:h,"aria-labelledby":"traffic chart type "+h,onChange:s,className:a}),t("div",{className:k.cnt,children:t(e,{...u})})]},h))})}const{useMemo:Ce}=_,we={plugins:{legend:{display:!1}},scales:{x:{display:!1,type:"category"},y:{display:!1,type:"linear"}}},R=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],ke=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],_e=R;function Se({id:e}){const o=W.read(),r=Ce(()=>({labels:_e,datasets:[{...L,...P[e].up,data:R},{...L,...P[e].down,data:ke}]}),[e]),l="chart-"+e;return H(o.Chart,l,r,null,we),t("div",{style:{width:100,padding:5},children:t("canvas",{id:l})})}const{useEffect:M,useState:xe,useCallback:f,useRef:Oe,useMemo:Ne}=_,Ie=[{id:0},{id:1},{id:2},{id:3}],Le=[["debug","Debug"],["info","Info"],["warning","Warning"],["error","Error"],["silent","Silent"]],Pe=[{key:"port",label:"HTTP Proxy Port"},{key:"socks-port",label:"SOCKS5 Proxy Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"}],je=[["zh","\u4E2D\u6587"],["en","English"]],Te=[["Global","Global"],["Rule","Rule"],["Direct","Direct"]],$e=e=>({configs:G(e),apiConfig:$(e)}),Re=e=>({selectedChartStyleIndex:Z(e),latencyTestUrl:ee(e),apiConfig:$(e)}),Me=T(Re)(Ae),Ue=T($e)(ze);function ze({dispatch:e,configs:o,apiConfig:r}){return M(()=>{e(q(r))},[e,r]),t(Me,{configs:o})}function Ae({dispatch:e,configs:o,selectedChartStyleIndex:r,latencyTestUrl:l,apiConfig:a}){const[s,u]=xe(o),h=Oe(o);M(()=>{h.current!==o&&u(o),h.current=o},[o]);const z=f(()=>{e(F("apiConfig"))},[e]),v=f((n,d)=>{u({...s,[n]:d})},[s]),A=f(n=>{const d="allow-lan",p=n;v(d,p),e(C(a,{"allow-lan":p}))},[a,e,v]),m=f(({name:n,value:d})=>{switch(n){case"mode":case"log-level":v(n,d),e(C(a,{[n]:d})),n==="log-level"&&te({...a,logLevel:d});break;case"redir-port":case"socks-port":case"mixed-port":case"port":if(d!==""){const p=parseInt(d,10);if(p<0||p>65535)return}v(n,d);break;default:return}},[a,e,v]),E=f(n=>m(n.target),[m]),{selectChartStyleIndex:B,updateAppConfig:x}=J(),O=f(n=>{const d=n.target,{name:p,value:I}=d;switch(p){case"port":case"socks-port":case"mixed-port":case"redir-port":{const b=parseInt(I,10);if(b<0||b>65535)return;e(C(a,{[p]:b}));break}case"latencyTestUrl":{x(p,I);break}default:throw new Error(`unknown input name ${p}`)}},[a,e,x]),D=Ne(()=>{const n=s.mode;return typeof n=="string"&&n[0].toUpperCase()+n.slice(1)},[s.mode]),{t:g,i18n:N}=K();return c("div",{children:[t(Q,{title:g("Config")}),c("div",{className:i.root,children:[Pe.map(n=>s[n.key]!==void 0?c("div",{children:[t("div",{className:i.label,children:n.label}),t(ie,{name:n.key,value:s[n.key],onChange:E,onBlur:O})]},n.key):null),c("div",{children:[t("div",{className:i.label,children:"Mode"}),t(w,{options:Te,selected:D,onChange:n=>m({name:"mode",value:n.target.value})})]}),c("div",{children:[t("div",{className:i.label,children:"Log Level"}),t(w,{options:Le,selected:s["log-level"],onChange:n=>m({name:"log-level",value:n.target.value})})]}),c("div",{children:[t("div",{className:i.label,children:"Allow LAN"}),t("div",{className:i.wrapSwitch,children:t(X,{name:"allow-lan",checked:s["allow-lan"],onChange:A})})]})]}),t("div",{className:i.sep,children:t("div",{})}),c("div",{className:i.section,children:[c("div",{children:[t("div",{className:i.label,children:g("latency_test_url")}),t(de,{name:"latencyTestUrl",type:"text",value:l,onBlur:O})]}),c("div",{children:[t("div",{className:i.label,children:g("lang")}),t("div",{children:t(w,{options:je,selected:N.language,onChange:n=>N.changeLanguage(n.target.value)})})]}),c("div",{children:[t("div",{className:i.label,children:g("chart_style")}),t(be,{OptionComponent:Se,optionPropsList:Ie,selectedIndex:r,onChange:B})]}),c("div",{children:[c("div",{className:i.label,children:[g("current_backend"),t("p",{children:a.baseURL})]}),t("div",{className:i.label,children:"Action"}),t(Y,{start:t(se,{size:16}),label:g("switch_backend"),onClick:z})]})]})]})}export{Ue as default};
